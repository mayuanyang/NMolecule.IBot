{"version":3,"names":[],"mappings":"","sources":["homeLayoutController.js"],"sourcesContent":["\r\nexport default class homeLayoutController{\r\n    constructor($http, $stateParams, $filter, httpService, $interval) {\r\n        this.$http = $http;\r\n\t\tthis.$interval = $interval;\r\n\t\tthis.$http.defaults.headers.common.Authorization = 'BotConnector kaPcdAksQ_M.cwA.jQk.K-BStvNcDBLqbWrjRLGoo4pvsn1hlmpyO6PfxunmPY8' ;\r\n        this.message = '';\r\n        this.messages = [];\r\n        this.models = [];\r\n        //this.showDemoData();\r\n\r\n        this.getRequestToken()\r\n            .success(data => {\r\n                //console.log(data);\r\n                this.token = data;\r\n            });\r\n\r\n        this.startConversation()\r\n            .success(data => {\r\n                this.conversationId = data.conversationId;\r\n                this.getMessages();\r\n            });\r\n\t\t\r\n\t\t\r\n    }\r\n\t\r\n    getRequestToken() {\r\n\t\t\r\n             return this.$http.get('https://directline.botframework.com/api/tokens');\r\n    }\r\n\r\n    startConversation() {\r\n\t\t\r\n        return this.$http.post('https://directline.botframework.com/api/conversations');\r\n    }\r\n\r\n    postMessage() {\r\n        this.$http({\r\n            method: 'POST',\r\n            url: 'https://directline.botframework.com/api/conversations/'+ this.conversationId + '/messages',\r\n            \r\n            data: { \r\n                \"text\": this.message\r\n            } \r\n        }).success(data => {\r\n            this.message = '';\r\n        });\r\n    }\r\n\r\n    getMessages() {\r\n\t\tvar self = this;\r\n\t\tvar var_1=this.$interval(function() {\r\n\t\t    self.$http.get('https://directline.botframework.com/api/conversations/' + self.conversationId + '/messages')\r\n\t\t        .success(data => {\r\n\t\t            for(var i in data.messages) {\r\n\t\t                console.log(i);\r\n\t\t                var msg = data.messages[i];\r\n\t\t                console.log(msg);\r\n\t\t                if (msg) {\r\n\t\t                    self.messages.push(msg.text);\r\n\t\t                    var result = {\r\n\t\t                        data: msg.attachments[0],\r\n\t\t                        name: msg.text\r\n\t\t                    };\r\n\t\t                    self.models.push(result);\r\n\t\t                    console.log('message added');\r\n\t\t                }\r\n\t\t            }\r\n\r\n\r\n\t\t        });\r\n\t\t},5000);\r\n    }\r\n\r\n    showDemoData() {\r\n\t\t\r\n\t\t\r\n        var dynamicContent = {\r\n\t\t\tdata: {\r\n\t\t\t\t\"name String\" : \"eddy\",\r\n\t\t\t\t\"gender String\" : \"male\",\r\n\t\t\t\t\"age String\" : \"35\",\r\n\t\t\t\t\"thing Object\" : { \"firstName\" : \"yuan\", \"lastName\" : \"ma\"},\r\n\t\t\t\t\"array Only\" : [\"aa\", \"bb\", \"cc\"],\r\n\t\t\t\t\"schema\":[\r\n\t\t\t\t  {\"data_type\":\"string\", \"display_name\":\"MyField123\"},\r\n\t\t\t\t  {\"data_type\":\"file\", \"display_name\":\"MyField456\"},\r\n\t\t\t\t  {\"data_type\":\"checkbox\", \"display_name\":\"MyField789\"}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tname: \"test\"\r\n\t\t};\r\n\t\t\r\n\t\tvar listData = {\r\n\t\tdata: ['aaa', 'bbb'],\r\n\t\tname: \"list data\"\r\n\t\t};\r\n\t\t\r\n\t\tthis.models.push(dynamicContent);\r\n\t\tthis.models.push(listData);\r\n\t\r\n    }\r\n\t\r\n\t\r\n};\r\n\r\nhomeLayoutController.$inject = ['$http', '$stateParams', '$filter', 'httpService', '$interval'];"],"file":"homeLayoutController.js","sourceRoot":"/source/"}